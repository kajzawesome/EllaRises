<%- include('../partials/header', { title: 'Dashboard' }) %>

<title><%= title || "Dashboard" %></title>

<div class="admin-container">

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <h3><span class="lang-en">Admin Tools</span><span class="lang-es">Herramientas Admin</span></h3>
        <a class="admin-btn" href="/admin/dashboard"> <span class="lang-en">Dashboard</span><span class="lang-es">Panel</span></a>
        <a class="admin-btn" href="/admin/add-event"> <span class="lang-en">Add Event/Program</span><span class="lang-es">Agregar Evento/Programa</span></a>
        <a class="admin-btn" href="/admin/manageevents"> <span class="lang-en">Manage Events</span><span class="lang-es">Administrar Eventos</span></a>
        <a class="admin-btn" href="/admin/manageusers"> <span class="lang-en">Manage Users</span><span class="lang-es">Administrar Usuarios</span></a>
        <a class="admin-btn" href="/admin/surveys"> <span class="lang-en">Manage Surveys</span><span class="lang-es">Administrar Encuestas</span></a>
        <a class="admin-btn" href="/admin/managedonations"> <span class="lang-en">Manage Donations</span><span class="lang-es">Administrar Donaciones</span></a>
    </aside>

    <!-- Main Content -->
    <main class="admin-main">

        <!-- Tableau Section -->
        <section class="tableau-section">
            <h2>
                <span class="lang-en">Program & Event Analytics</span>
                <span class="lang-es">Analítica de Programas y Eventos</span>
            </h2>

            <div class='tableau-container' id='viz1764865842408' style='position: relative'><noscript>
                <a href='#'><img alt='ER Dashboard ' src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;
                    ER&#47;ERDashboard1-10&#47;ERDashboard&#47;1_rss.png' style='border: none' /></a></noscript>
                    <object class='tableauViz'  style='display:none;'><param name='host_url' 
                        value='https%3A%2F%2Fpublic.tableau.com%2F' /> <param name='embed_code_version' value='3' /> 
                        <param name='site_root' value='' /><param name='name' value='ERDashboard1-10&#47;ERDashboard' />
                        <param name='tabs' value='no' /><param name='toolbar' value='yes' />
                        <param name='static_image' value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;
                        ER&#47;ERDashboard1-10&#47;ERDashboard&#47;1.png' /> <param name='animate_transition' 
                        value='yes' /><param name='display_static_image' value='yes' /><param name='display_spinner' 
                        value='yes' /><param name='display_overlay' value='yes' /><param name='display_count' 
                        value='yes' /><param name='language' value='en-US' /><param name='filter' value='publish=yes' />
                    </object></div>                
                    <script type='text/javascript'>                    
                        var divElement = document.getElementById('viz1764865842408');                    
                        var vizElement = divElement.getElementsByTagName('object')[0];                    
                        if ( divElement.offsetWidth > 800 ) 
                        { vizElement.style.width='1366px';vizElement.style.height='795px';} 
                        else if ( divElement.offsetWidth > 500 ) 
                        { vizElement.style.width='1366px';vizElement.style.height='795px';} 
                        else { vizElement.style.width='100%';vizElement.style.height='1377px';}                     
                        var scriptElement = document.createElement('script');                    
                        scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';                    
                        vizElement.parentNode.insertBefore(scriptElement, vizElement);                
                    </script>

        <!-- Upcoming Events & Occurrences -->
        <section class="upcoming-items">
            <h2>
                <span class="lang-en">Upcoming Programs & Events</span>
                <span class="lang-es">Próximos Programas y Eventos</span>
            </h2>

            <% if (events && events.length > 0) { %>

                <% events.forEach(event => { %>

                    <div class="admin-item-card">

                        <div class="admin-item-details">
                            <h3><%= event.eventname %></h3>

                            <p>
                                <strong><span class="lang-en">Type:</span>
                                        <span class="lang-es">Tipo:</span>
                                </strong>
                                <%= event.eventtype %>
                            </p>

                            <p>
                                <strong><span class="lang-en">Next Occurrence:</span>
                                        <span class="lang-es">Próxima Sesión:</span>
                                </strong>

                                <% if (event.nextdate) { %>
                                    <%= new Date(event.nextdate).toLocaleDateString() %>
                                <% } else { %>
                                    <span class="lang-en">No upcoming sessions</span>
                                    <span class="lang-es">No hay próximas sesiones</span>
                                <% } %>
                            </p>

                            <p>
                                <strong><span class="lang-en">Location:</span>
                                        <span class="lang-es">Ubicación:</span>
                                </strong>

                                <%= event.eventlocation || "" %>
                            </p>
                        </div>

                        <form action="/admin/event/<%= event.eventid %>/edit" method="GET" style="display:inline;">
                            <button type="submit" class="edit-btn">
                                <span class="lang-en">Edit</span>
                                <span class="lang-es">Editar</span>
                            </button>
                        </form>
                    </div>

                <% }) %>

            <% } else { %>
                <p>
                    <span class="lang-en">No upcoming programs or events.</span>
                    <span class="lang-es">No hay próximos programas o eventos.</span>
                </p>
            <% } %>

        </section>

    </main>

</div>

<%- include('../partials/footer') %>