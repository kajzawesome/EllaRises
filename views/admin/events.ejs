<%- include('../partials/header', { title: 'Dashboard' }) %>

<title><%= title || "Dashboard" %></title>

<div class="admin-container">

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <h3><span class="lang-en">Admin Tools</span><span class="lang-es">Herramientas Admin</span></h3>
        <a class="admin-btn" href="/admin/dashboard"> <span class="lang-en">Dashboard</span><span class="lang-es">Panel</span></a>
        <a class="admin-btn" href="/admin/add-event"> <span class="lang-en">Add Event/Program</span><span class="lang-es">Agregar Evento/Programa</span></a>
        <a class="admin-btn" href="/admin/manageevents"> <span class="lang-en">Manage Events</span><span class="lang-es">Administrar Eventos</span></a>
        <a class="admin-btn" href="/admin/manageusers"> <span class="lang-en">Manage Users</span><span class="lang-es">Administrar Usuarios</span></a>
        <a class="admin-btn" href="/admin/surveys"> <span class="lang-en">Manage Surveys</span><span class="lang-es">Administrar Encuestas</span></a>
        <a class="admin-btn" href="/admin/managedonations"> <span class="lang-en">Manage Donations</span><span class="lang-es">Administrar Donaciones</span></a>
    </aside>

    <main class="admin-main">

        <!-- Search Bar -->
        <form method="GET" action="/admin/manageevents" style="margin: 20px 0; text-align:center;">
            <input 
                type="text"
                name="search"
                value="<%= search || '' %>"
                placeholder="Search event name, type, or location..."
                style="padding: 8px; width: 260px; border-radius: 6px; border: 1px solid #ccc;"
            >

            <button class="admin-btn" type="submit">
                <span class="lang-en">Search</span>
                <span class="lang-es">Buscar</span>
            </button>

            <% if (search) { %>
                <a href="/admin/manageevents" class="admin-btn" style="background:#777; margin-left:10px;">
                    <span class="lang-en">Clear</span>
                    <span class="lang-es">Limpiar</span>
                </a>
            <% } %>
        </form>

        <!-- Events & Occurrences -->
        <section class="upcoming-items" style="margin: 20px auto; max-width: 600px;">
            <h2>
                <span class="lang-en">All Programs & Events</span>
                <span class="lang-es">Todos los Programas y Eventos</span>
            </h2>

            <% if (events && events.length > 0) { %>

                <% events.forEach(event => { %>

                    <div class="admin-item-card">

                        <div class="admin-item-details">
                            <h3><%= event.eventname %></h3>

                            <p>
                                <strong><span class="lang-en">Type:</span>
                                        <span class="lang-es">Tipo:</span>
                                </strong>
                                <%= event.eventtype %>
                            </p>

                            <p>
                                <strong><span class="lang-en">Next Occurrence:</span>
                                        <span class="lang-es">Pr贸xima Sesi贸n:</span>
                                </strong>

                                <% if (event.nextdate) { %>
                                    <%= new Date(event.nextdate).toLocaleDateString() %>
                                <% } else { %>
                                    <span class="lang-en">No upcoming sessions</span>
                                    <span class="lang-es">No hay pr贸ximas sesiones</span>
                                <% } %>
                            </p>

                            <p>
                                <strong><span class="lang-en">Location:</span>
                                        <span class="lang-es">Ubicaci贸n:</span>
                                </strong>

                                <%= event.eventlocation || "" %>
                            </p>
                        </div>

                        <form action="/admin/event/<%= event.eventid %>/edit" method="GET" style="display:inline;">
                            <button type="submit" class="edit-btn">
                                <span class="lang-en">Edit</span>
                                <span class="lang-es">Editar</span>
                            </button>
                        </form>
                    </div>

                <% }) %>

            <% } else { %>
                <p>
                    <span class="lang-en">No programs or events found.</span>
                    <span class="lang-es">No se encontraron programas o eventos.</span>
                </p>
            <% } %>

        </section>

    </main>

</div>

<%- include('../partials/footer') %>