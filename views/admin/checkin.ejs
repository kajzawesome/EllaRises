<%- include('../partials/header', { title: "Event Check-In" }) %>

<div class="admin-container">

    <aside class="admin-sidebar">
        <h3><span class="lang-en">Admin Tools</span><span class="lang-es">Herramientas Admin</span></h3>
        <a class="admin-btn" href="/admin/dashboard"> <span class="lang-en">Dashboard</span><span class="lang-es">Panel</span></a>
        <a class="admin-btn" href="/admin/add-event"> <span class="lang-en">Add Event/Program</span><span class="lang-es">Agregar Evento/Programa</span></a>
        <a class="admin-btn" href="/manageevents"> <span class="lang-en">Manage Events</span><span class="lang-es">Administrar Eventos</span></a>
        <a class="admin-btn" href="/admin/manageusers"> <span class="lang-en">Manage Users</span><span class="lang-es">Administrar Usuarios</span></a>
        <a class="admin-btn" href="/admin/survey-responses"> <span class="lang-en">Manage Surveys</span><span class="lang-es">Administrar Encuestas</span></a>
        <a class="admin-btn" href="/admin/managedonations"> <span class="lang-en">Manage Donations</span><span class="lang-es">Administrar Donaciones</span></a>
    </aside>

    <h1>Event Check-In</h1>

    <h2><%= occurrence.eventname %></h2>

    <p>
        <strong>Date:</strong> <%= occurrence.eventdatestart.toLocaleDateString() %><br>
        <strong>Time:</strong> <%= occurrence.eventtimestart %><br>
        <strong>Location:</strong> <%= occurrence.eventlocation %>
    </p>

    <table class="checkin-table">
        <thead>
            <tr>
                <th>Participant</th>
                <th>Email</th>
                <th>Status</th>
                <th>Check-In</th>
            </tr>
        </thead>

        <tbody>
            <% registrations.forEach(r => { %>
                <tr>
                    <td>
                        <%= r.participantfirstname %> 
                        <%= r.participantlastname %>
                    </td>

                    <td><%= r.participantemail %></td>

                    <td>
                        <% if (r.registrationattendedflag) { %>
                            <span class="badge green">Checked In</span>
                        <% } else { %>
                            <span class="badge red">Not Checked In</span>
                        <% } %>
                    </td>

                    <td>
                        <% if (!r.registrationattendedflag) { %>
                            <form method="POST" action="/admin/events/checkin/<%= r.registrationid %>">
                                <button class="btn-small btn-green">
                                    Check In
                                </button>
                            </form>
                        <% } else { %>
                            <em>Done</em>
                        <% } %>
                    </td>
                </tr>
            <% }) %>
        </tbody>
    </table>

</div>

<%- include('../partials/footer') %>