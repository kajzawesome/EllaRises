<%- include('../partials/header', { title: "Event Check-In" }) %>

<div class="admin-container">

    <!-- Sidebar -->
    <aside class="admin-sidebar">
        <h3><span class="lang-en">Admin Tools</span><span class="lang-es">Herramientas Admin</span></h3>

        <a class="admin-btn" href="/admin/dashboard">Dashboard</a>
        <a class="admin-btn" href="/admin/add-event">Add Event/Program</a>
        <a class="admin-btn" href="/manageevents">Manage Events</a>
        <a class="admin-btn" href="/admin/manageusers">Manage Users</a>
        <a class="admin-btn" href="/admin/survey-responses">Manage Surveys</a>
        <a class="admin-btn" href="/admin/managedonations">Manage Donations</a>
    </aside>


    <!-- Main Content -->
    <main class="admin-main">

        <!-- Page Title -->
        <h2 class="page-title-sm">
            <span class="lang-en">Event Check-In</span>
            <span class="lang-es">Registro del Evento</span>
        </h2>

        <!-- Event Summary Card -->
        <div class="compact-card">

            <h3 class="section-title-sm"><%= occurrence.eventname %></h3>

            <div class="summary-grid">

                <div>
                    <strong>Date:</strong>
                    <div><%= occurrence.eventdatestart.toLocaleDateString() %></div>
                </div>

                <div>
                    <strong>Time:</strong>
                    <div><%= occurrence.eventtimestart %></div>
                </div>

                <div>
                    <strong>Location:</strong>
                    <div><%= occurrence.eventlocation %></div>
                </div>

            </div>
        </div>


        <!-- Check-In Table -->
        <div class="compact-card">

            <table class="checkin-table clean-table">
                <thead>
                    <tr>
                        <th>Participant</th>
                        <th>Email</th>
                        <th>Status</th>
                        <th>Check-In</th>
                    </tr>
                </thead>

                <tbody>
                    <% registrations.forEach(r => { %>
                        <tr>
                            <td><%= r.participantfirstname %> <%= r.participantlastname %></td>
                            <td><%= r.participantemail %></td>

                            <td>
                                <% if (r.registrationattendedflag) { %>
                                    <span class="badge-soft green">Checked In</span>
                                <% } else { %>
                                    <span class="badge-soft red">Not Checked In</span>
                                <% } %>
                            </td>

                            <td>
                                <% if (!r.registrationattendedflag) { %>
                                    <form method="POST" action="/admin/events/checkin/<%= r.registrationid %>">
                                        <button class="compact-btn btn-checkin">Check In</button>
                                    </form>
                                <% } else { %>
                                    <span class="badge-soft gray">Done</span>
                                <% } %>
                            </td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>

        </div>

    </main>

</div>

<%- include('../partials/footer') %>