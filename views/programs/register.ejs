<%- include('../partials/header', { title: title || 'Register' }) %>

<div class="register-page">
    <h1>
        <span class="lang-en"><%= title || 'Register' %></span>
        <span class="lang-es"><%= title_es || 'Registrarse' %></span>
    </h1>

    <% if (user) { %>

        <!-- PAST EVENTS/PROGRAMS -->
        <% if (pastItems && pastItems.length > 0) { %>
            <section class="past-items">
                <h2>
                    <span class="lang-en">Past <%= type %></span>
                    <span class="lang-es"><%= type_es %> Pasadas</span>
                </h2>
                <div class="item-container">
                    <% pastItems.forEach(item => { %>
                        <div class="item-card">
                            <h3><%= item.name %></h3>
                            <p><%= item.date.toLocaleDateString() %></p>
                            <% if (!item.surveyCompleted) { %>
                                <form action="/<%= type.toLowerCase() %>/survey/<%= item.id %>" method="GET">
                                    <button type="submit">
                                        <span class="lang-en">Fill Out Survey</span>
                                        <span class="lang-es">Completar Encuesta</span>
                                    </button>
                                </form>
                            <% } else { %>
                                <span class="completed">
                                    <span class="lang-en">Survey Completed</span>
                                    <span class="lang-es">Encuesta Completada</span>
                                </span>
                            <% } %>
                        </div>
                    <% }) %>
                </div>
            </section>
        <% } %>

        <!-- UPCOMING REGISTERED EVENTS/PROGRAMS -->
        <% if (upcomingRegistered && upcomingRegistered.length > 0) { %>
            <section class="upcoming-registered">
                <h2>
                    <span class="lang-en">Your Upcoming <%= type %></span>
                    <span class="lang-es">Tus Próximas <%= type_es %></span>
                </h2>
                <div class="item-container">
                    <% upcomingRegistered.forEach(item => { %>
                        <div class="item-card">
                            <h3><%= item.name %></h3>
                            <p><%= item.date.toLocaleDateString() %></p>
                            <span class="registered">
                                <span class="lang-en">Registered</span>
                                <span class="lang-es">Registrado</span>
                            </span>
                        </div>
                    <% }) %>
                </div>
            </section>
        <% } %>

        <!-- ALL UPCOMING EVENTS/PROGRAMS -->
        <% if (availableItems && availableItems.length > 0) { %>
            <section class="available-items">
                <h2>
                    <span class="lang-en">Available <%= type %></span>
                    <span class="lang-es"><%= type_es %> Disponibles</span>
                </h2>
                <div class="item-container">
                    <% availableItems.forEach(item => { %>
                        <div class="item-card">
                            <h3><%= item.name %></h3>
                            <p><%= item.date.toLocaleDateString() %></p>
                            <form action="/<%= type.toLowerCase() %>/register/<%= item.id %>" method="POST">
                                <button type="submit">
                                    <span class="lang-en">Register</span>
                                    <span class="lang-es">Registrarse</span>
                                </button>
                            </form>
                        </div>
                    <% }) %>
                </div>
            </section>
        <% } else { %>
            <p>
                <span class="lang-en">No upcoming <%= type %> available.</span>
                <span class="lang-es">No hay <%= type_es %> disponibles próximamente.</span>
            </p>
        <% } %>

    <% } else { %>
        <!-- Not logged in -->
        <p>
            <span class="lang-en">Please <a href="/login?context=enroll">login</a> to view and register for <%= type %>.</span>
            <span class="lang-es">Por favor <a href="/login?context=enroll">inicie sesión</a> para ver y registrarse en <%= type_es %>.</span>
        </p>
    <% } %>
</div>

<%- include('../partials/footer') %>
