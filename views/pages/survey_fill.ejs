<%- include('../partials/header', { title: 'Event Survey' }) %>

<div class="admin-container">

  <% if (user && user.level === "M") { %>
    <aside class="admin-sidebar">
        <h3>Admin Tools</h3>

        <a class="admin-btn" href="/admin/dashboard">Dashboard</a>
        <a class="admin-btn" href="/admin/add-event">Add Event/Program</a>
        <a class="admin-btn" href="/admin/manageevents">Manage Events</a>
        <a class="admin-btn" href="/admin/manageusers">Manage Users</a>
        <a class="admin-btn" href="/admin/survey-responses">Manage Surveys</a>
        <a class="admin-btn" href="/admin/managedonations">Manage Donations</a>
    </aside>
  <% } %>

  <main class="admin-main">

    <h2 class="page-title">Event Survey</h2>

    <!-- EVENT INFO -->
    <div class="survey-event-info">
      <h3><%= occurrence.eventname %></h3>

      <p>
        <strong>Participant:</strong>
        <%= participant.participantfirstname %> <%= participant.participantlastname %><br>

        <strong>Date:</strong>
        <%= occurrence.eventdatestart ? occurrence.eventdatestart.toISOString().split("T")[0] : "" %>
        @ <%= occurrence.eventtimestart %>
      </p>
    </div>


    <!-- SURVEY FORM -->
    <form action="/survey/submit/<%= registrationid %>" method="POST" class="survey-form-card">

      <h3>Please Evaluate Your Experience</h3>

      <!-- GRID OF FOUR RATING DROPDOWNS -->
      <div class="survey-grid">

        <div class="survey-field">
          <label>Overall Satisfaction</label>
          <select name="satisfactionscore" required>
            <option value="">Select</option>
            <% for (let i = 1; i <= 5; i++) { %>
              <option value="<%= i %>" <%= survey && survey.satisfactionscore == i ? "selected" : "" %>><%= i %></option>
            <% } %>
          </select>
        </div>

        <div class="survey-field">
          <label>Usefulness of the Event</label>
          <select name="usefulnessscore" required>
            <option value="">Select</option>
            <% for (let i = 1; i <= 5; i++) { %>
              <option value="<%= i %>" <%= survey && survey.usefulnessscore == i ? "selected" : "" %>><%= i %></option>
            <% } %>
          </select>
        </div>

        <div class="survey-field">
          <label>Instructor / Facilitator Quality</label>
          <select name="instructorscore" required>
            <option value="">Select</option>
            <% for (let i = 1; i <= 5; i++) { %>
              <option value="<%= i %>" <%= survey && survey.instructorscore == i ? "selected" : "" %>><%= i %></option>
            <% } %>
          </select>
        </div>

        <div class="survey-field">
          <label>Likelihood to Recommend</label>
          <select name="recommendationscore" required>
            <option value="">Select</option>
            <% for (let i = 1; i <= 5; i++) { %>
              <option value="<%= i %>" <%= survey && survey.recommendationscore == i ? "selected" : "" %>><%= i %></option>
            <% } %>
          </select>
        </div>

      </div><!-- end grid -->


      <!-- COMMENTS -->
      <div class="survey-field-full">
        <label>Additional Comments</label>
        <textarea name="comments" rows="4"><%= survey ? survey.comments : "" %></textarea>
      </div>

      <button type="submit" class="button survey-submit-btn">
        Submit Survey
      </button>

    </form>

  </main>
</div>

<%- include('../partials/footer') %>
